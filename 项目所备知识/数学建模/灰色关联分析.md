灰色关联分析主要有两个作用：
- 进行系统分析
- 用来综合评价（AHP、Topsis都是综合评价的）

![](../../img/Pasted%20image%2020250817212132.png)

注：参加美赛尽量不要用灰色关联分析，因为很多外国人不知道这个，这个是国内提出的。最好用回归分析那些数理统计的方法。


### 系统分析

什么是系统？是指一般的抽象系统，比如说，社会系统、经济系统、农业系统、生态系统等。

灰色关联分析的基本思想是根据序列曲线==几何形状的相似程度==来判断其联系是否紧密。曲线越接近，相应序列之间的关联度就越大，反之就越小。


### 应用一：进行系统分析

![](../../img/Pasted%20image%2020250817201619.png)

由于这里只给了六年的数据（n太小），所以如果用回归，效果可能没有那么显著。

![](../../img/Pasted%20image%2020250817202532.png)

##### 第一步：画统计图

画图后配上简单的分析，e.g：
1. 四个变量均呈上升的趋势
2. 第二产业的增幅较为明显
3. 第二产业和第三产业的差距在后三年相差更大

##### 第二步：确定分析数列

(1) 母序列（又称参考数列、母指标）：能反映系统行为特征的数据序列（例如经济系统中的GDP）。 -> 类似于因变量`Y`，此处记为x<sub>0</sub>。
(2) 子序列（又称比较数列、子指标）：影响系统行为的因素组成的数据序列。 -> 类似于自变量`X`，此处记为(x<sub>1</sub>, x<sub>2</sub>, ... , x<sub>m</sub>)

一般母序列只有一个，子序列有多个。
在本例中：国内生产总值（x<sub>0</sub>）就是母序列，第一（x<sub>1</sub>）、第二（x<sub>2</sub>）、第三产业（x<sub>3</sub>）就是子序列。


##### 第三步：对变量进行预处理

这一步主要是两个目的：
- ==去量纲==
- ==缩小变量范围，简化运算==

对母序列和子序列中的每个指标进行预处理：先求出每个指标的均值，再用该指标中的每个元素都除以其均值。

![](../../img/Pasted%20image%2020250817203634.png)


##### 第四步：计算子序列中各个指标与母序列的关联系数

![](../../img/Pasted%20image%2020250817210536.png)

用`a`表示两极最小差，用`b`表示两极最大差。

![](../../img/Pasted%20image%2020250817210623.png)

![](../../img/Pasted%20image%2020250817211115.png)


##### 第五步：定义灰色关联度

![](../../img/Pasted%20image%2020250817211605.png)

![](../../img/Pasted%20image%2020250817210812.png)

计算后观察哪一个子序列的灰色关联度最大，灰色关联度越大代表其对母序列的影响越大。


##### 第六步：比较子序列的灰色关联度，得出结论

通过比较三个子序列和母序列的关联度可以得到结论：
该地区在2000年至2005年间的国内生产总值受到第三产业的影响最大。（其灰色关联度最大）


可以用[mean()函数](Matlab部分语法.md#mean()函数)来计算算术平均值。


### 讨论

1. 什么时候用标准化回归，什么时候用灰色关联分析？
答：当样本个数`n`较大时，一般使用标准化回归；当样本个数`n`较小时，才使用灰色关联分析。

2. 如果母序列有多个指标，应该怎么分析？
例如：Y<sub>1</sub>和Y<sub>2</sub>是母序列，X<sub>1</sub>、X<sub>2</sub>、... 、X<sub>m</sub>是子序列
答：那么我们首先计算Y<sub>1</sub>和X<sub>1</sub>、X<sub>2</sub>、... 、X<sub>m</sub>的灰色关联度并进行分析，再计算Y<sub>2</sub>和X<sub>1</sub>、X<sub>2</sub>、... 、X<sub>m</sub>的灰色关联度并进行分析。（也就是分开分析，分开讨论）



## 应用二

![](../../img/Pasted%20image%2020250817214308.png)

关于综合评价，之前介绍过两个模型：[层次分析法](层次分析法.md)和[TOPSIS法](TOPSIS法.md)。它们的区别是：AHP是用于没有数据（表格中的数据需要自己填），TOPSIS则是用于有数据的情况。而本节的灰色关联分析也是适用于==有数据==的情况。

由于指标通常有不同的权重，可以用AHP也可以用熵权法（数学建模一般用熵权法就可以了）

下面是解决步骤：

#### Step1：对指标进行正向化

[正向化](TOPSIS法.md#第一步：将原始矩阵正向化)是为了让最后的得分有意义。

#### Step2：对正向化后的矩阵进行预处理，得到矩阵Z<sub>n×m</sub> = (Z<sub>ij</sub>)<sub>n×m</sub>

#### Step3：将预处理后的矩阵每一行的最大值取出构成母序列（这个母序列是虚构的）

#### Step4：计算各指标与母序列的灰色关联度（灰色关联度相当于权重）：r<sub>1</sub>、r<sub>2</sub>、...、r<sub>m</sub>

#### Step5：计算各个指标的权重（相当于归一化）

公式：

**w<sub>1</sub>=r<sub>1</sub>/( r<sub>1</sub> + r<sub>2</sub> + ... + r<sub>m</sub>)** 、 **w<sub>2</sub>=r<sub>2</sub>/( r<sub>1</sub> + r<sub>2</sub> + ... + r<sub>m</sub>)** 、 ... 、**w<sub>m</sub>=r<sub>m</sub>/( r<sub>1</sub> + r<sub>2</sub> + ... + r<sub>m</sub>)** 

#### Step6：计算第`k`个评价对象的得分

将某评价对象的每个指标正向化和预处理后的值乘以它对应的一个权重，然后加起来，就是这个对象的得分：
![](../../img/Pasted%20image%2020250818095523.png)

#### Step7：对得分进行归一化

S<sub>1</sub>' = S<sub>1</sub> / ( S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub> )、
S<sub>2</sub>' = S<sub>2</sub> / ( S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub> )、
...
S<sub>n</sub>' = S<sub>n</sub> / ( S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub> )


最后在进行排序后画个图（柱状图或折线图）：

![](../../img/Pasted%20image%2020250818100201.png)

