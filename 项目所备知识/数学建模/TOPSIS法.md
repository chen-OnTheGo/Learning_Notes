
![](../../img/Pasted%20image%2020250817120332.png)

先举例：

![](../../img/Pasted%20image%2020250817120445.png)

根据分数排名，其名次越小越好，但我们需要用评分来描述，评分却越大越好，这样就矛盾了，所以我们需要对排名进行一个修正

![](../../img/Pasted%20image%2020250817120527.png)

但我们这个想法有个不合理之处：若清风考了90分，分数变低，但因为其名次仍然是第一，所以其排名不变，相应的评分也就不会变了。所以我们这个评分不能足够的反映我们原始数据的全部信息。

![](../../img/Pasted%20image%2020250817121308.png)

为什么我们不能直接用`x/100-0`呢？也就是：

![](../../img/Pasted%20image%2020250817121641.png)

原因如下：

![](../../img/Pasted%20image%2020250817121701.png)

现在我们增加指标个数：

![](../../img/Pasted%20image%2020250817121819.png)

这里由于成绩越高越好，争吵次数越少越好，所以两者的评判规则不一样，我们就将其分类——极大型指标和极小型指标。

然后进行处理，先==统一指标类型==：

**指标正向化**是常用的一种统一指标类型的方法，若用到了这个方法一定要记得在论文中写出来。

![](../../img/Pasted%20image%2020250817122152.png)

由于两个指标的量纲不同，也就是单位不同，所以还需要进行==标准化处理==来消去它们的量纲差距。

![](../../img/Pasted%20image%2020250817122554.png)

这里我们有4个要评价的对象，2个评价指标：

![](../../img/Pasted%20image%2020250817122646.png)

然后计算得分：

![](../../img/Pasted%20image%2020250817122820.png)

![](../../img/Pasted%20image%2020250817122906.png)

这里的`Z`是标准化后的矩阵，最小值就是把`Z`每一列中的最小值拿出来组成一个向量。最大值就是把`Z`每一列中的最大值拿出来组成一个向量。

回到刚才那个问题：

![](../../img/Pasted%20image%2020250817150956.png)

先找表格里面每列的最大值和最小值，然后就来分别计算每个人对最大值和最小值的距离：

![](../../img/Pasted%20image%2020250817151221.png)

通过其“归一化后的得分”，就能反应综合考虑的结果

![](../../img/Pasted%20image%2020250817151344.png)


### 第一步：将原始矩阵正向化

刚才只介绍了两种指标，其实还有其他类型的指标： ^7e92a9

![](../../img/Pasted%20image%2020250817151638.png)

所谓的将原始矩阵（图中字打错了）正向化，就是要将作用的指标类型统一转化为极大型指标。（转换的函数形式可以不唯一）。

![](../../img/Pasted%20image%2020250817151818.png)

建议用 `max-x`，因为用该公式没有限定条件，而`1/x`的限定条件是所有元素均为正数。

![](../../img/Pasted%20image%2020250817152014.png)

![](../../img/Pasted%20image%2020250817152243.png)


### 第二步：正向化矩阵标准化

用于消除量纲。
正向化后的矩阵需要写在论文的附录里面（因为矩阵可能比较大，所以需要放在附录里面。

![](../../img/Pasted%20image%2020250817152544.png)


### 第三步：计算得分并归一化

![](../../img/Pasted%20image%2020250817152623.png)


### 例题

![](../../img/Pasted%20image%2020250817152745.png)

分析可得：`含氧量`是极大型，`PH值`是中间型，`细菌总数`是极小型，`植物性营养物量`是区间型。
所以第一步就是把不是极大型的三种转化为极大型。
第二步就是把转化后的正向化矩阵标准化
第三步就是计算得分并归一化。

![](../../img/Pasted%20image%2020250817153851.png)
相应知识点请跳转到[magic函数](Matlab部分语法.md#magic函数)

### 模型拓展

在上面例子中，我们默认了“成绩”和“正向化后的争吵次数”这两个指标的权重相同。

![](../../img/Pasted%20image%2020250817154706.png)

若遇到不同指标有不同权重的情况怎么办？

![](../../img/Pasted%20image%2020250817154837.png)

![](../../img/Pasted%20image%2020250817154852.png)




## 基于熵权法对Topsis模型的修正

![](../../img/Pasted%20image%2020250817165403.png)

这里的变异程度可以看成**方差**。

信息量越少权值越低，那我们如何来度量信息量的多少呢？

![](../../img/Pasted%20image%2020250817165518.png)

越有可能发生的事，信息量越少；
越不可能发生的事，信息量越多。

![](../../img/Pasted%20image%2020250817165722.png)

![](../../img/Pasted%20image%2020250817170018.png)

![](../../img/Pasted%20image%2020250817170243.png)

随机变量的信息熵越大，则它的值（内容）能给我们补充的信息量越大，而知道这个值之前我们已有的信息越小。
所以，信息熵越大，信息量越小。

下面是熵权法的计算步骤：

![](../../img/Pasted%20image%2020250817170459.png)

![](../../img/Pasted%20image%2020250817170702.png)

![](../../img/Pasted%20image%2020250817170934.png)

d<sub>j</sub> 恒大于等于0。

![](../../img/Pasted%20image%2020250817171405.png)


### 实现

![](../../img/Pasted%20image%2020250817172101.png)
输出的是权重。

用`mylog()` 处理`p`为 0 的情况：
![](../../img/Pasted%20image%2020250817172148.png)

在topsis中的部分修改：

![](../../img/Pasted%20image%2020250817172322.png)
### 若论文要发表，建议别用熵权法

若只是用这个方法比赛，那么就可以随便用，因为这个方法比我们自己随意定义好。

![](../../img/Pasted%20image%2020250817171708.png)

![](../../img/Pasted%20image%2020250817171721.png)